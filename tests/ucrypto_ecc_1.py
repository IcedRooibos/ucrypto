try:
    from _crypto import ECC
except ImportError:
    print("SKIP")
    raise SystemExit

P256 = ECC.Curve(
    115792089210356248762697446949407573530086143415290314195533631308867097853951,
    -3,
    41058363725152142129326129780047268409114441015993725554835256314039467401291,
    115792089210356248762697446949407573529996955224135760342422259061068512044369,
    48439561293906451759052585252797914202762949526041747995844080717082404635286,
    36134250956749795798585127919587881956611106672985015071877198253568414405109
)

print(P256)

p1 = ECC.Point(
    38744637563132252572193375526521585173096338380822965394069276390274998769771,
    38053931953835384495674052639602881660154657110782968445504801383088376660758,
    P256
)

p2 = ECC.Point(
    38744637563132252572193375526521585173096338380822965394069276390274998769771,
    38053931953835384495674052639602881660154657110782968445504801383088376660758,
    P256
)

print("p1 == p2", ECC.point_equal(p1, p2))

p1_double = ECC.point_double(p1, P256)
print("p1_double =", hex(p1_double.x), hex(p1_double.y))

p3 = ECC.Point(
    100477533340815411662634551128749658785907042636435106397366501380429417453513,
    87104997799923409786648856004022766656120419079854375215656946413621911659094,
    P256
)

p4 = ECC.Point(
    38744637563132252572193375526521585173096338380822965394069276390274998769771,
    38053931953835384495674052639602881660154657110782968445504801383088376660758,
    P256
)

p3_add_p4 = ECC.point_add(p3, p4, P256)
print("p3_add_p4 =", hex(p3_add_p4.x), hex(p3_add_p4.y))

s = 89159128863034313675150798691418246016730671603224848136445263738857221457661
p3_mul_s = ECC.point_mul(p3, s, P256)
print("p3_mul_s =", hex(p3_mul_s.x), hex(p3_mul_s.y))

MSG1 = "7c3e883ddc8bd688f96eac5e9324222c8f30f9d6bb59e9c5f020bd39ba2b8377"

def sig_1():
    d = 50943806327475185293816970514366636821920319930380020090017203768578844832650
    k = 39829592034059986307320252987069559181398147068430738908176417355568654468560
    return ECC.ecdsa_sign(MSG1, d, k, P256)
signature = sig_1()
print("signature =", hex(signature.r), hex(signature.s))

Q = ECC.Point(
    58351759285569456841203950926840863508341048817129505008197573360161397309608,
    97984338924949822393423337845758537525394383183490037930900081872624647455657,
    P256
)

print("verify =", ECC.ecdsa_verify(signature, MSG1, Q, P256))

MSG2 = "39a5e04aaff7455d9850c605364f514c11324ce64016960d23d5dc57d3ffd8f49a739468ab8049bf18eef820cdb1ad6c9015f838556bc7fad4138b23fdf986c7"
def sig_2():
    d2 = 91225253027397101270059260515990221874496108017261222445699397644687913215777
    k2 = 43266746841974544773532444486781911654986416052841296107072964405748691319461
    return ECC.ecdsa_sign(MSG2, d2, k2, P256)
signature2 = sig_2()
print("signature =", hex(signature2.r), hex(signature2.s))
